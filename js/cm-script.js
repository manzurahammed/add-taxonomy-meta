$ = jQuery.noConflict();$(document).ready(function($) {	var file_frame;	$.fn.uploadMediaFile = function( button, preview_media,multiple=false ) {		var button_id = button.attr('id');		var field_id = button_id.replace( '_button', '' );		var preview_id = button_id.replace( '_button', '_preview' );				// If the media frame already exists, reopen it.		if ( file_frame ) {		  file_frame.open();		  return;		}		// Create the media frame.		file_frame = wp.media.frames.file_frame = wp.media({		  title: $( this ).data( 'uploader_title' ),		  button: {			text: $( this ).data( 'uploader_button_text' ),		  },		  multiple: multiple		});		// When an image is selected, run a callback.		file_frame.on( 'select', function() {			if(multiple){				attachment = file_frame.state().get('selection').map(function(attachment){					attachment.toJSON();					return attachment;				});				var appenID = field_id+'_list';				for (i = 0; i < attachment.length; ++i) {					var main = attachment[i].attributes;					$("#"+appenID).append($.fn.ppp_add(main,field_id));				}			}else{				attachment = file_frame.state().get('selection').first().toJSON();				$("#"+field_id).val(attachment.id);				if( preview_media ) {					$("#"+preview_id).show();					$("#"+preview_id).attr('src',attachment.sizes.thumbnail.url);				}			}		});		// Finally, open the modal		file_frame.open();	}	$.fn.ppp_add = function(value,id) {		var markup = '';		markup += '<li class="single-image"  id="image-remove-'+value.id+'">'; 			markup += '<span data-image-pos-id="'+value.id+'" class="dashicons dashicons-dismiss image-remove"></span>';      			markup += '<image class="preview-image" height="50px" width="50px" src="'+value.url+'" >';      			markup += '<input type="hidden" name="'+id+'['+value.id+']" value="'+value.id+'" class="preview-image" >';		markup += '</li>';		return markup;	}	$('.image_upload_button').click(function() {		$.fn.uploadMediaFile( $(this), true);	});	$('.multie-image-upload').click(function() {		$.fn.uploadMediaFile( $(this), true,true );	});	$(document).on('click','.image-remove',function(){		var id = $(this).data('image-pos-id');		$('#image-remove-'+id).remove();	});	$('.image_delete_button').click(function() {		var imagstr = $(this).attr('id');		var res = imagstr.replace("_delete", "");		$('#'+res).val(' ');		$( '.image_preview' ).hide();		return false;	});});